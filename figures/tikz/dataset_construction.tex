\documentclass[tikz,border=10pt]{standalone}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{amsmath}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{shapes.geometric, arrows.meta, positioning, shadows, patterns, decorations.pathreplacing, calc, fadings, matrix}

% Define professional color palette
\definecolor{natblue}{RGB}{41,128,185}
\definecolor{natgreen}{RGB}{39,174,96}
\definecolor{natorange}{RGB}{230,126,34}
\definecolor{natpurple}{RGB}{142,68,173}
\definecolor{natred}{RGB}{231,76,60}
\definecolor{natgray}{RGB}{52,73,94}
\definecolor{lightgray}{RGB}{236,240,241}
\definecolor{mdacolor}{RGB}{255,87,87}  % MDA specific color
\definecolor{bulkcolor}{RGB}{70,130,180} % Bulk specific color

\begin{document}

% Define styles
\tikzset{
	% Data source blocks
	datasource/.style={
			rectangle,
			rounded corners=12pt,
			draw=natgray,
			line width=1.5pt,
			top color=#1!20,
			bottom color=#1!5,
			minimum height=3cm,
			minimum width=3.5cm,
			text centered,
			font=\sffamily\large\bfseries,
			drop shadow={shadow scale=1.05, shadow xshift=2pt, shadow yshift=-2pt, fill=#1!30}
		},
	% Chimeric read representation
	chimeric/.style={
			rectangle,
			rounded corners=8pt,
			draw=#1,
			line width=1.2pt,
			fill=#1!15,
			minimum height=1.5cm,
			minimum width=2.5cm,
			text centered,
			font=\sffamily\normalsize,
			drop shadow={shadow scale=1.03, shadow xshift=1pt, shadow yshift=-1pt, fill=#1!20}
		},
	% Classification box
	classbox/.style={
			rectangle,
			rounded corners=10pt,
			draw=#1,
			line width=1.8pt,
			top color=#1!25,
			bottom color=#1!8,
			minimum height=2.5cm,
			minimum width=2.8cm,
			text centered,
			font=\sffamily\large\bfseries,
			drop shadow={shadow scale=1.06, shadow xshift=2pt, shadow yshift=-2pt, fill=#1!35}
		},
	% Arrow style
	arrow/.style={
			->,
			>=stealth,
			line width=2pt,
			natgray!80,
			shorten >=3pt,
			shorten <=3pt
		},
	% Comparison arrow
	comparrow/.style={
			<->,
			>=Stealth,
			line width=1.5pt,
			#1,
			shorten >=2pt,
			shorten <=2pt
		},
	% Title style
	titlebox/.style={
			rectangle,
			rounded corners=10pt,
			draw=natblue,
			line width=2pt,
			top color=natblue!15,
			bottom color=white,
			font=\sffamily\Huge\bfseries,
			text=natblue!90,
			inner sep=10pt,
			drop shadow={shadow scale=1.05, shadow xshift=3pt, shadow yshift=-3pt, fill=natblue!30}
		},
	% Legend style
	legendbox/.style={
			rectangle,
			draw=natgray!60,
			line width=1.2pt,
			rounded corners=6pt,
			top color=natgray!8,
			bottom color=white,
			font=\sffamily\small,
			inner sep=8pt,
			drop shadow={shadow scale=1.02, shadow xshift=1pt, shadow yshift=-1pt, fill=natgray!15}
		}
}

\begin{tikzpicture}[node distance=1cm, every node/.style={transform shape}]

	% Title
	\node[titlebox] at (8, 12) {Dataset Construction Workflow};

	% Data sources
	\node[datasource=mdacolor] (mda) at (2, 8) {
		\begin{tabular}{c}
			\textbf{MDA Data}     \\[3pt]
			\normalsize Contains  \\
			\normalsize Chimeric  \\
			\normalsize Artifacts \\[2pt]
			\textcolor{mdacolor!80}{\footnotesize Nanopore}
		\end{tabular}
	};

	\node[datasource=bulkcolor, right = of mda] (bulk1) {
		\begin{tabular}{c}
			\textbf{Bulk Data 1}    \\[3pt]
			\normalsize No Chimeric \\
			\normalsize Artifacts   \\[2pt]
			\textcolor{bulkcolor!80}{\footnotesize Reference}
		\end{tabular}
	};

	\node[datasource=bulkcolor, right = 10pt of bulk1] (bulk2) {
		\begin{tabular}{c}
			\textbf{Bulk Data 2}    \\[3pt]
			\normalsize No Chimeric \\
			\normalsize Artifacts   \\[2pt]
			\textcolor{bulkcolor!80}{\footnotesize Reference}
		\end{tabular}
	};

	\node[datasource=bulkcolor, right= 10pt of bulk2] (bulk3) {
		\begin{tabular}{c}
			\textbf{Bulk Data 3}    \\[3pt]
			\normalsize No Chimeric \\
			\normalsize Artifacts   \\[2pt]
			\textcolor{bulkcolor!80}{\footnotesize Reference}
		\end{tabular}
	};

	% Chimeric reads from MDA
	\node[chimeric=mdacolor, below= of mda] (mdachimeric) {
		\begin{tabular}{c}
			\textbf{MDA}      \\
			\textbf{Chimeric} \\
			\textbf{Reads}
		\end{tabular}
	};

	% Chimeric reads from Bulk data
	\node[chimeric=bulkcolor, below = of bulk1] (bulkchimeric1)  {
		\begin{tabular}{c}
			\textbf{Bulk 1}   \\
			\textbf{Chimeric} \\
			\textbf{Reads}
		\end{tabular}
	};

	\node[chimeric=bulkcolor, below = of bulk2] (bulkchimeric2) {
		\begin{tabular}{c}
			\textbf{Bulk 2}   \\
			\textbf{Chimeric} \\
			\textbf{Reads}
		\end{tabular}
	};

	\node[chimeric=bulkcolor, below = of bulk3] (bulkchimeric3) {
		\begin{tabular}{c}
			\textbf{Bulk 3}   \\
			\textbf{Chimeric} \\
			\textbf{Reads}
		\end{tabular}
	};

	% Support classification - better spacing
	\node[classbox=natred, below= 7cm of mdachimeric] (sup0) {
		\begin{tabular}{c}
			\textbf{Match 0}         \\[2pt]
			\footnotesize Artificial \\
			\footnotesize Chimeric   \\[2pt]
			\textcolor{natred!80}{\tiny 0/3 Bulk Match}
		\end{tabular}
	};

	\node[classbox=natgreen, right = 2cm of sup0] (sup1)  {
		\begin{tabular}{c}
			\textbf{Match 1}         \\[2pt]
			\footnotesize Biological \\
			\footnotesize Chimeric   \\[2pt]
			\textcolor{natgreen!80}{\tiny 1/3 Bulk Match}
		\end{tabular}
	};

	\node[classbox=natgreen, right = of sup1] (sup2) {
		\begin{tabular}{c}
			\textbf{Match 2}         \\[2pt]
			\footnotesize Biological \\
			\footnotesize Chimeric   \\[2pt]
			\textcolor{natgreen!80}{\tiny 2/3 Bulk Match}
		\end{tabular}
	};

	\node[classbox=natgreen, right = of sup2] (sup3)  {
		\begin{tabular}{c}
			\textbf{Match 3}         \\[2pt]
			\footnotesize Biological \\
			\footnotesize Chimeric   \\[2pt]
			\textcolor{natgreen!80}{\tiny 3/3 Bulk Match}
		\end{tabular}
	};

	% Final classification - better spacing
	\node[classbox=natpurple, below = 1.5cm of sup0] (artificial)  {
		\begin{tabular}{c}
			\textbf{Artificial}   \\[2pt]
			\footnotesize Class 0 \\[2pt]
		\end{tabular}
	};

	\node[classbox=natblue, below = 1.5cm of sup2] (biological)  {
		\begin{tabular}{c}
			\textbf{Biological}   \\[2pt]
			\footnotesize Class 1 \\[2pt]
		\end{tabular}
	};

	% Arrows
	\draw[arrow] (mda.south) -- (mdachimeric.north);
	\draw[arrow] (bulk1.south) -- (bulkchimeric1.north);
	\draw[arrow] (bulk2.south) -- (bulkchimeric2.north);
	\draw[arrow] (bulk3.south) -- (bulkchimeric3.north);

	% Central Comparison Process Engine
	\node[rectangle, below= 1.5cm of mdachimeric, xshift=7cm, draw=natorange, line width=2.5pt, rounded corners=15pt,
		top color=natorange!25, bottom color=natorange!5,
		minimum height=3.5cm, minimum width=8cm,
		text centered, font=\sffamily\large\bfseries,
		drop shadow={shadow scale=1.08, shadow xshift=3pt, shadow yshift=-3pt, fill=natorange!40}] (compengine) {
		\begin{tabular}{c}
			\textbf{\Large Comparison}                          \\[2pt]
			\textbf{\Large Engine}                              \\[6pt]
			\normalsize Match Counting                          \\[2pt]
			\normalsize Algorithm                               \\[4pt]
			\textcolor{natorange!80}{\small For each MDA read:} \\[1pt]
			\textcolor{natorange!80}{\small Count bulk matches}
		\end{tabular}
	};

	% Arrows from data sources to comparison engine - pure vertical straight connections
	\draw[arrow] (mdachimeric.east) to[out=10,in=170,looseness=0.6] (compengine.west);
	\draw[arrow] (bulkchimeric1.south) -- (bulkchimeric1.south |- compengine.north);
	\draw[arrow] (bulkchimeric2.south) -- (bulkchimeric2.south |- compengine.north);
	\draw[arrow] (bulkchimeric3.south) to[out=240,in=40,looseness=0.8] (compengine.north east);

	% Classification arrows from comparison engine to support groups - distributed starting points
	\draw[arrow] (compengine.south west) to[out=200,in=90,looseness=0.8] (sup0.north);
	\draw[arrow] (compengine.south) to[out=240,in=90,looseness=0.6] (sup1.north);
	\draw[arrow] (compengine.south) to[out=300,in=90,looseness=0.6] (sup2.north);
	\draw[arrow] (compengine.south east) to[out=340,in=90,looseness=0.8] (sup3.north);

	% Classification arrows - smooth and well-spaced
	\draw[arrow] (sup0.south) -- (artificial.north);
	\draw[arrow] (sup1.south) to[out=270,in=120,looseness=0.8] (biological.north west);
	\draw[arrow] (sup2.south) to[out=270,in=90,looseness=0.6] (biological.north);
	\draw[arrow] (sup3.south) to[out=270,in=60,looseness=0.8] (biological.north east);

\end{tikzpicture}

\end{document}
